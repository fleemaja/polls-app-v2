<head>
    <title>New Poll</title>
    
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet" type="text/css">
	<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css">
	<link href="/public/css/main.css" rel="stylesheet" type="text/css">
</head>

<%- include header.ejs %>

<body>
    <div class="container">
      <div class="col-sm-6 col-sm-offset-3">
        <h1>Make a New Poll!</h1>
        
        <!-- frontend form validation -->
        <div class="alert alert-danger alert-category">Poll must have a category</div>
        <div class="alert alert-danger alert-options">Poll must have at least two options</div>
        
        <form action="/newpoll" method="post">
            <fieldset class="form-group">
                <label for="pollTitleInput">Title:</label>
                <input name="title" type="text" class="form-control" id="pollTitleInput" placeholder="Enter Poll Title">
            </fieldset>
            <div class="form-group">
              <label for="pollCategoryInput">Select Category:</label>
              <select name="category" class="form-control" id="pollCategoryInput">
                <option selected disabled hidden style='display: none' value=''></option>
                <option value="sports">Sports &amp; Fitness</option>
                <option value="movies">TV &amp; Movies</option>
                <option value="music">Music &amp; Art</option>
                <option value="food">Food &amp; Travel</option>
                <option value="science">Science &amp; Technology</option>
                <option value="news">News &amp; Politics</option>
                <option value="misc">Miscellaneous</option>
              </select>
            </div>
            <fieldset class="form-group">
                <label for="pollOptionsInput">Options (separated by line):</label>
                <textarea name="options" class="form-control" id="pollOptionsInput" rows="4"></textarea>
            </fieldset>
            <button type="submit" class="btn btn-warning btn-lg">Submit</button>
        </form>
      </div>
    </div>
    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    
    <script>
        $(document).ready(function() {
          $('form').on('submit', function(e){
            // validation code here
            var valid = true;
            var rawOptions = $('#pollOptionsInput').val();
            var optionsArr = rawOptions.split("\n");
            optionsArr = optionsArr.filter(function(o) { return o != '' });
            if ($('#pollCategoryInput').val() == null) {
                valid = false;
                $('.alert-category').show();
            }
            if (optionsArr.length < 2) {
                valid = false;
                $('.alert-options').show();
            }
            if(!valid) {
              e.preventDefault();
            }
          });
        });
    </script>
</body>